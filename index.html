<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìä Unwritten Studio Feedback</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #f5f7fa;
            color: #333;
            padding: 20px;
        }
        .container { max-width: 900px; margin: 0 auto; }
        header {
            background: linear-gradient(135deg, #3987b8 0%, #2a5f8d 100%);
            color: white;
            padding: 40px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 8px 24px rgba(57, 135, 184, 0.3);
        }
        header h1 { font-size: 36px; margin-bottom: 10px; }
        header p { font-size: 16px; opacity: 0.9; }

        .tabs {
            display: flex;
            background: white;
            border-radius: 12px 12px 0 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .tab-btn {
            flex: 1;
            padding: 16px;
            border: none;
            background: white;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        .tab-btn:first-child { border-radius: 12px 0 0 0; }
        .tab-btn.active {
            color: #3987b8;
            border-bottom-color: #3987b8;
            background: #f9fafb;
        }

        .content {
            background: white;
            padding: 40px;
            border-radius: 0 0 12px 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .section { display: none; }
        .section.active { display: block; }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            margin-bottom: 30px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3987b8 0%, #2a5f8d 100%);
            width: 0%;
            transition: width 0.3s;
        }

        .question {
            margin-bottom: 35px;
            padding-bottom: 35px;
            border-bottom: 1px solid #f0f0f0;
        }
        .question:last-child { border: none; }

        .q-num {
            display: inline-block;
            background: #3987b8;
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .q-text {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: block;
        }

        .options { display: flex; flex-direction: column; gap: 10px; }
        .option {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: #f9fafb;
            border: 2px solid transparent;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
        }
        .option:hover { border-color: #3987b8; background: #f0f4f9; }
        .option input { margin-right: 12px; cursor: pointer; width: 18px; height: 18px; accent-color: #3987b8; }
        .option label { cursor: pointer; flex: 1; margin: 0; }

        .rating {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        .rating-btn {
            padding: 10px 14px;
            background: #f0f0f0;
            border: 2px solid transparent;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            min-width: 45px;
            text-align: center;
            font-family: inherit;
        }
        .rating-btn:hover { border-color: #3987b8; }
        .rating-btn.active { background: #3987b8; color: white; border-color: #3987b8; }

        textarea, input[type="email"] {
            width: 100%;
            padding: 12px;
            border: 2px solid #f0f0f0;
            border-radius: 6px;
            font-family: inherit;
            font-size: 14px;
            transition: all 0.2s;
            margin-top: 5px;
        }
        textarea:focus, input:focus { outline: none; border-color: #3987b8; background: #f9fafb; }
        textarea { min-height: 100px; resize: vertical; }

        .buttons {
            display: flex;
            gap: 12px;
            margin-top: 40px;
        }
        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
            font-family: inherit;
        }
        .btn-submit {
            background: linear-gradient(135deg, #3987b8 0%, #2a5f8d 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(57, 135, 184, 0.3);
        }
        .btn-submit:hover:not(:disabled) { transform: translateY(-2px); }
        .btn-submit:disabled { background: #ccc; cursor: not-allowed; }

        .btn-reset { background: white; border: 2px solid #3987b8; color: #3987b8; }
        .btn-reset:hover { background: #f9fafb; }

        .message {
            display: none;
            padding: 16px;
            margin-bottom: 20px;
            border-radius: 6px;
            border-left: 4px solid;
            font-weight: 500;
        }
        .message.show { display: block; animation: slideDown 0.3s; }
        @keyframes slideDown { from { transform: translateY(-10px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .message.success { background: #d1fae5; border-color: #10b981; color: #065f46; }
        .message.error { background: #fee2e2; border-color: #dc2626; color: #7f1d1d; }

        .analytics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat {
            background: linear-gradient(135deg, #f0f4f9 0%, white 100%);
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e5e7eb;
        }
        .stat-label { font-size: 12px; color: #3987b8; font-weight: bold; margin-bottom: 8px; }
        .stat-value { font-size: 28px; color: #3987b8; font-weight: bold; }

        .chart {
            background: #f9fafb;
            padding: 20px;
            border-radius: 8px;
            margin: 30px 0;
            display: flex;
            align-items: flex-end;
            gap: 8px;
            height: 150px;
        }
        .bar { flex: 1; background: linear-gradient(180deg, #3987b8 0%, #2a5f8d 100%); border-radius: 4px 4px 0 0; }

        .surveys {
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            max-height: 400px;
            overflow-y: auto;
        }
        .survey {
            padding: 16px;
            border-bottom: 1px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .survey:last-child { border: none; }
        .survey-email { color: #3987b8; font-weight: 600; font-size: 14px; }
        .survey-nps { display: inline-block; background: #f0f0f0; padding: 4px 10px; border-radius: 12px; font-size: 12px; color: #3987b8; font-weight: 600; }

        .exports {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .btn-export {
            padding: 10px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            font-size: 13px;
            transition: all 0.2s;
            font-family: inherit;
        }
        .btn-export:hover { transform: translateY(-2px); }
        .btn-json { background: #3987b8; color: white; }
        .btn-csv { background: #059669; color: white; }
        .btn-delete { background: #dc2626; color: white; }

        .empty { text-align: center; padding: 40px; color: #999; }

        h3 { color: #3987b8; margin: 20px 0 15px 0; font-size: 16px; }

        @media (max-width: 768px) {
            header h1 { font-size: 24px; }
            .tabs { flex-direction: column; }
            .buttons { flex-direction: column; }
            .rating { justify-content: space-between; }
            .rating-btn { flex: 1; min-width: auto; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä Unwritten Studio</h1>
            <p>Feedback zur Homepage & Pr√§senz</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" data-tab="form">üìã Umfrage</button>
            <button class="tab-btn" data-tab="analytics">üìà Analyse</button>
        </div>

        <div class="content">
            <!-- FORM -->
            <div id="form" class="section active">
                <div id="message" class="message"></div>
                <div class="progress-bar"><div class="progress-fill"></div></div>
                <form id="feedbackForm">
                    <div class="question">
                        <span class="q-num">1 / 12</span>
                        <label class="q-text">Wie haben Sie uns entdeckt?</label>
                        <div class="options">
                            <div class="option"><input type="radio" name="q1" value="Suchmaschine"><label>üîç Suchmaschine</label></div>
                            <div class="option"><input type="radio" name="q1" value="Social Media"><label>üì± Social Media</label></div>
                            <div class="option"><input type="radio" name="q1" value="Empfehlung" checked><label>üë• Empfehlung</label></div>
                            <div class="option"><input type="radio" name="q1" value="Direkter Link"><label>üîó Direkter Link</label></div>
                        </div>
                    </div>

                    <div class="question">
                        <span class="q-num">2 / 12</span>
                        <label class="q-text">Emotionale Reaktion?</label>
                        <div class="options">
                            <div class="option"><input type="radio" name="q2" value="Inspiriert"><label>‚ú® Inspiriert</label></div>
                            <div class="option"><input type="radio" name="q2" value="Neugierig" checked><label>ü§î Neugierig</label></div>
                            <div class="option"><input type="radio" name="q2" value="Verwirrt"><label>‚ùå Verwirrt</label></div>
                            <div class="option"><input type="radio" name="q2" value="Neutral"><label>üòê Neutral</label></div>
                        </div>
                    </div>

                    <div class="question">
                        <span class="q-num">3 / 12</span>
                        <label class="q-text">Konzept verst√§ndlich? (1-5)</label>
                        <div class="rating">
                            <button type="button" class="rating-btn" data-q="q3" data-val="1">1</button>
                            <button type="button" class="rating-btn" data-q="q3" data-val="2">2</button>
                            <button type="button" class="rating-btn" data-q="q3" data-val="3">3</button>
                            <button type="button" class="rating-btn active" data-q="q3" data-val="4">4</button>
                            <button type="button" class="rating-btn" data-q="q3" data-val="5">5</button>
                        </div>
                    </div>

                    <div class="question">
                        <span class="q-num">4 / 12</span>
                        <label class="q-text">Welche Showcases interessieren Sie?</label>
                        <div class="options">
                            <div class="option"><input type="checkbox" name="q4" value="Pantopia" checked><label>üåç Pantopia</label></div>
                            <div class="option"><input type="checkbox" name="q4" value="Thesis"><label>üìö Thesis</label></div>
                            <div class="option"><input type="checkbox" name="q4" value="Wetware" checked><label>üì∞ Wetware</label></div>
                            <div class="option"><input type="checkbox" name="q4" value="Libraries"><label>üìñ Libraries</label></div>
                            <div class="option"><input type="checkbox" name="q4" value="Hallo"><label>üíª Hallo</label></div>
                        </div>
                    </div>

                    <div class="question">
                        <span class="q-num">5 / 12</span>
                        <label class="q-text">Design & √Ñsthetik? (1-5)</label>
                        <div class="rating">
                            <button type="button" class="rating-btn" data-q="q5" data-val="1">1</button>
                            <button type="button" class="rating-btn" data-q="q5" data-val="2">2</button>
                            <button type="button" class="rating-btn" data-q="q5" data-val="3">3</button>
                            <button type="button" class="rating-btn active" data-q="q5" data-val="4">4</button>
                            <button type="button" class="rating-btn" data-q="q5" data-val="5">5</button>
                        </div>
                    </div>

                    <div class="question">
                        <span class="q-num">6 / 12</span>
                        <label class="q-text">Navigation einfach? (1-5)</label>
                        <div class="rating">
                            <button type="button" class="rating-btn" data-q="q6" data-val="1">1</button>
                            <button type="button" class="rating-btn" data-q="q6" data-val="2">2</button>
                            <button type="button" class="rating-btn" data-q="q6" data-val="3">3</button>
                            <button type="button" class="rating-btn" data-q="q6" data-val="4">4</button>
                            <button type="button" class="rating-btn active" data-q="q6" data-val="5">5</button>
                        </div>
                    </div>

                    <div class="question">
                        <span class="q-num">7 / 12</span>
                        <label class="q-text">Was fehlt?</label>
                        <textarea name="q7" placeholder="Ihre Vorschl√§ge..."></textarea>
                    </div>

                    <div class="question">
                        <span class="q-num">8 / 12</span>
                        <label class="q-text">Gew√ºnschte Inhalte?</label>
                        <div class="options">
                            <div class="option"><input type="checkbox" name="q8" value="Pricing" checked><label>üí∞ Pricing</label></div>
                            <div class="option"><input type="checkbox" name="q8" value="UseCases" checked><label>üéØ Use Cases</label></div>
                            <div class="option"><input type="checkbox" name="q8" value="TechDetails"><label>üîß Tech</label></div>
                            <div class="option"><input type="checkbox" name="q8" value="Testimonials"><label>üí¨ Testimonials</label></div>
                            <div class="option"><input type="checkbox" name="q8" value="Demos"><label>üì∫ Demos</label></div>
                        </div>
                    </div>

                    <div class="question">
                        <span class="q-num">9 / 12</span>
                        <label class="q-text">Immersion & Interaktivit√§t?</label>
                        <textarea name="q9" placeholder="Ihr Feedback..."></textarea>
                    </div>

                    <div class="question">
                        <span class="q-num">10 / 12</span>
                        <label class="q-text">Companion interessant? (1-5)</label>
                        <div class="rating">
                            <button type="button" class="rating-btn" data-q="q10" data-val="1">1</button>
                            <button type="button" class="rating-btn" data-q="q10" data-val="2">2</button>
                            <button type="button" class="rating-btn" data-q="q10" data-val="3">3</button>
                            <button type="button" class="rating-btn active" data-q="q10" data-val="4">4</button>
                            <button type="button" class="rating-btn" data-q="q10" data-val="5">5</button>
                        </div>
                    </div>

                    <div class="question">
                        <span class="q-num">11 / 12</span>
                        <label class="q-text">Von welchem Ger√§t?</label>
                        <div class="options">
                            <div class="option"><input type="radio" name="q11" value="Desktop"><label>üíª Desktop</label></div>
                            <div class="option"><input type="radio" name="q11" value="Mobile"><label>üì± Mobile</label></div>
                            <div class="option"><input type="radio" name="q11" value="Beides" checked><label>‚öñÔ∏è Beides</label></div>
                        </div>
                    </div>

                    <div class="question">
                        <span class="q-num">12 / 12</span>
                        <label class="q-text">Unwritten empfehlen? (1-10)</label>
                        <div class="rating">
                            <button type="button" class="rating-btn" data-q="q12" data-val="1">1</button>
                            <button type="button" class="rating-btn" data-q="q12" data-val="2">2</button>
                            <button type="button" class="rating-btn" data-q="q12" data-val="3">3</button>
                            <button type="button" class="rating-btn" data-q="q12" data-val="4">4</button>
                            <button type="button" class="rating-btn" data-q="q12" data-val="5">5</button>
                            <button type="button" class="rating-btn" data-q="q12" data-val="6">6</button>
                            <button type="button" class="rating-btn" data-q="q12" data-val="7">7</button>
                            <button type="button" class="rating-btn active" data-q="q12" data-val="8">8</button>
                            <button type="button" class="rating-btn" data-q="q12" data-val="9">9</button>
                            <button type="button" class="rating-btn" data-q="q12" data-val="10">10</button>
                        </div>
                    </div>

                    <div class="question">
                        <label class="q-text">üìß Ihre E-Mail</label>
                        <input type="email" name="email" placeholder="ihre@email.com" required>
                    </div>

                    <div class="buttons">
                        <button type="submit" class="btn btn-submit">‚úì Senden</button>
                        <button type="reset" class="btn btn-reset">‚Üª Zur√ºcksetzen</button>
                    </div>
                </form>
            </div>

            <!-- ANALYTICS -->
            <div id="analytics" class="section">
                <div class="analytics">
                    <div class="stat">
                        <div class="stat-label">üìä Umfragen</div>
                        <div class="stat-value" id="count">0</div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">‚≠ê NPS</div>
                        <div class="stat-value" id="nps">0</div>
                    </div>
                    <div class="stat">
                        <div class="stat-label">üé® Design</div>
                        <div class="stat-value" id="design">0</div>
                    </div>
                </div>

                <h3>üìå Showcases</h3>
                <div class="chart" id="chart"></div>

                <div class="exports">
                    <button class="btn-export btn-json" onclick="exportJSON()">üì• JSON</button>
                    <button class="btn-export btn-csv" onclick="exportCSV()">üìä CSV</button>
                    <button class="btn-export btn-delete" onclick="clearData()">üóëÔ∏è L√∂schen</button>
                </div>

                <h3>üìã Surveys</h3>
                <div class="surveys" id="surveys"></div>
            </div>
        </div>
    </div>

    <script>
        const form = document.getElementById('feedbackForm');
        const msg = document.getElementById('message');

        // TAB SWITCHING
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const tab = this.dataset.tab;
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                document.getElementById(tab).classList.add('active');
                this.classList.add('active');
                if (tab === 'analytics') loadAnalytics();
            });
        });

        // RATING BUTTONS
        document.querySelectorAll('.rating-btn').forEach(btn => {
            btn.addEventListener('click', function(e) {
                e.preventDefault();
                const q = this.dataset.q;
                const val = this.dataset.val;
                this.parentElement.querySelectorAll('.rating-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                let input = form.querySelector(`input[name="${q}"]`);
                if (!input) {
                    input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = q;
                    form.appendChild(input);
                }
                input.value = val;
                updateProgress();
            });
        });

        // PROGRESS UPDATE
        function updateProgress() {
            const inputs = form.querySelectorAll('input, textarea');
            let filled = 0;
            inputs.forEach(inp => {
                if (inp.type === 'hidden') return;
                if (inp.type === 'radio' || inp.type === 'checkbox') {
                    if (inp.checked) filled++;
                } else if (inp.value.trim()) filled++;
            });
            const pct = Math.round((filled / inputs.length) * 100);
            document.querySelector('.progress-fill').style.width = pct + '%';
        }

        // MESSAGES
        function showMsg(text, type) {
            msg.textContent = text;
            msg.className = `message ${type} show`;
            setTimeout(() => msg.classList.remove('show'), 4000);
        }

        // STORAGE
        function save(data) {
            let surveys = JSON.parse(localStorage.getItem('surveys') || '[]');
            surveys.push(data);
            localStorage.setItem('surveys', JSON.stringify(surveys));
        }

        function getSurveys() {
            return JSON.parse(localStorage.getItem('surveys') || '[]');
        }

        // FORM SUBMIT
        form.addEventListener('submit', async e => {
            e.preventDefault();
            const btn = form.querySelector('.btn-submit');
            btn.disabled = true;
            btn.textContent = '‚è≥...';

            const data = new FormData(form);
            const email = data.get('email');

            if (!email.includes('@')) {
                showMsg('‚ùå Email ung√ºltig', 'error');
                btn.disabled = false;
                btn.textContent = '‚úì Senden';
                return;
            }

            const survey = { timestamp: new Date().toISOString(), email: email, answers: {} };
            for (let [k, v] of data.entries()) {
                if (k !== 'email' && k.startsWith('q')) {
                    if (!survey.answers[k]) survey.answers[k] = [];
                    survey.answers[k].push(v);
                }
            }

            save(survey);

            try {
                await fetch('https://formspree.io/f/xkgodbqk', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        email: email,
                        message: `SURVEY\nZeit: ${new Date().toLocaleString('de-DE')}\nAnswers: ${JSON.stringify(survey.answers, null, 2)}`,
                        _subject: `üìä Feedback von ${email}`,
                        _replyto: email
                    })
                });
                showMsg('‚úÖ Email gesendet!', 'success');
            } catch (e) {
                showMsg('‚úÖ Lokal gespeichert!', 'success');
            }

            btn.disabled = false;
            btn.textContent = '‚úì Senden';
            setTimeout(() => form.reset(), 1500);
        });

        form.addEventListener('change', updateProgress);
        form.addEventListener('input', updateProgress);

        // ANALYTICS
        function loadAnalytics() {
            const surveys = getSurveys();
            document.getElementById('count').textContent = surveys.length;

            const nps = surveys.map(s => parseInt(s.answers.q12?.[0] || 0)).filter(n => n > 0);
            document.getElementById('nps').textContent = nps.length ? (nps.reduce((a, b) => a + b) / nps.length).toFixed(1) : '0';

            const design = surveys.map(s => parseInt(s.answers.q5?.[0] || 0)).filter(n => n > 0);
            document.getElementById('design').textContent = design.length ? (design.reduce((a, b) => a + b) / design.length).toFixed(1) : '0';

            const showcases = { 'Pantopia': 0, 'Thesis': 0, 'Wetware': 0, 'Libraries': 0, 'Hallo': 0 };
            surveys.forEach(s => {
                (s.answers.q4 || []).forEach(v => { if (showcases[v]) showcases[v]++; });
            });

            const maxShow = Math.max(...Object.values(showcases), 1);
            let chartHTML = '';
            Object.entries(showcases).forEach(([k, v]) => {
                chartHTML += `<div class="bar" style="height: ${(v / maxShow) * 100}%;"></div>`;
            });
            document.getElementById('chart').innerHTML = chartHTML;

            const surveyHTML = surveys.map((s, i) => `
                <div class="survey">
                    <div><div class="survey-email">${s.email}</div></div>
                    <span class="survey-nps">NPS: ${s.answers.q12?.[0] || '‚Äì'}</span>
                </div>
            `).reverse().join('');

            document.getElementById('surveys').innerHTML = surveyHTML || '<div class="empty">Keine Daten</div>';
        }

        function exportJSON() {
            const blob = new Blob([JSON.stringify(getSurveys(), null, 2)], { type: 'application/json' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'surveys.json';
            a.click();
        }

        function exportCSV() {
            const surveys = getSurveys();
            const csv = 'Email,NPS,Design,Zeit\n' + surveys.map(s => `"${s.email}","${s.answers.q12?.[0] || ''}","${s.answers.q5?.[0] || ''}","${s.timestamp}"`).join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const a = document.createElement('a');
            a.href = URL.createObjectURL(blob);
            a.download = 'surveys.csv';
            a.click();
        }

        function clearData() {
            if (confirm('Alle Daten wirklich l√∂schen?')) {
                localStorage.removeItem('surveys');
                loadAnalytics();
                showMsg('‚úÖ Gel√∂scht!', 'success');
            }
        }

        updateProgress();
    </script>
</body>
</html>
